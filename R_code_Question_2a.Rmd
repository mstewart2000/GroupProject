---
title: "R_code_Question_2A"
author: "mstewart2000"
date: "28/03/2022"
output: html_document
---

GitHub: https://github.com/mstewart2000/GroupProject

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Initial Setup

Package loading
```{r echo = FALSE}
library(ggplot2)
library(dplyr)
library(ggpubr)
```

Loading data set
```{r}
data = read.csv("./Data/GreenhouseData.csv")
```

Removing all but wanted data points
```{r}
data = data %>%
  select(BG_Dry_mg, PlantSpecies, SoilHostSpecies, Age)
```

# Setting up Data
The goal of this section is to determine which bacteria has the greatest effect on plant biomass when the plant is between 4 and 12 years old. This was chosen as this is the average age of the plants in the data set.

First I will create a new data set with only the plants that are this old.
```{r}
subdata = data %>%
  subset(Age == 4:12)
head(subdata)
```

Now with this data I can begin my analysis

# Analysis

I will use a boxplot to see the impact that the bacteria have on the plants that are this age
```{r}
Plot1 = ggplot(subdata, aes(x = SoilHostSpecies, y = BG_Dry_mg, fill = SoilHostSpecies)) +
  geom_boxplot() +
  theme_classic() +
    scale_fill_discrete(name = "Soil Bacteria") +
    scale_x_discrete(name = "", labels = c("","","","")) +
    scale_y_continuous(name = "Root Dry Mass (mg)")
Plot1
```

Based on this, we can see that Lupine has an impact on the dry weight of the roots between 4 and 12 years. To further examine this relationship, I will create a new set of data that groups together all the other species of soil bacteria, then create a boxplot using that set.
```{r}
new_subdata = subdata
  for (i in 1:length(subdata$PlantSpecies)) {
    if (subdata$SoilHostSpecies[i] != "Lupine"){
      new_subdata$SoilHostSpecies[i] = "Other"
    }
  }
```

Now I will recreate the plot with the new data set
```{r}
Plot2 = ggplot(new_subdata, aes(x = SoilHostSpecies, y = BG_Dry_mg, fill = SoilHostSpecies)) +
  geom_boxplot() +
  theme_classic() +
    scale_fill_discrete(name = "Soil Bacteria") +
    scale_x_discrete(name = "", labels = c("","")) +
    scale_y_continuous(name = "Root Dry Mass (mg)")
Plot2
```

Based on this graph we can see visually that there is a difference between samples with Lupine and all the other species of soil bacteria at this point in time.

Now I will conduct an unpaired two-sample t-test to determine if this difference between the two groups is significant or not. I am using a two-sample t-test as the two groups are unrelated.
```{r}
t.test(subset(new_subdata$BG_Dry_mg, new_subdata$SoilHostSpecies == "Other"),
       subset(new_subdata$BG_Dry_mg, new_subdata$SoilHostSpecies == "Lupine"),
              alternative = "two.sided", var.equal = FALSE)
```

Based on the results of this two-sample t-test, we can see that while there is a difference between the two groups, this difference is not enough for it to be considered significant as the p-value is not less that 0.05.